{"ast":null,"code":"import _regeneratorRuntime from\"/Users/adnan/Desktop/projects/setup/client-side/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/adnan/Desktop/projects/setup/client-side/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _objectSpread from\"/Users/adnan/Desktop/projects/setup/client-side/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _toConsumableArray from\"/Users/adnan/Desktop/projects/setup/client-side/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/adnan/Desktop/projects/setup/client-side/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useState}from'react';import{useParams,useNavigate}from'react-router-dom';import axios from'axios';import{useDispatch,useSelector}from'react-redux';import{getPost}from'../../store/postSlice';import{toast}from'react-toastify';export var useEditPost=function useEditPost(){var _useParams=useParams(),id=_useParams.id;var navigate=useNavigate();var _useSelector=useSelector(function(state){return state.post;}),post=_useSelector.post;var _useState=useState(true),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isEditing=_useState4[0],setIsEditing=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),title=_useState6[0],setTitle=_useState6[1];var _useState7=useState(post.links),_useState8=_slicedToArray(_useState7,2),links=_useState8[0],setLinks=_useState8[1];var _useState9=useState({}),_useState10=_slicedToArray(_useState9,2),image=_useState10[0],setImage=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),body=_useState12[0],setBody=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),listCount=_useState14[0],setListCount=_useState14[1];var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),path=_useState16[0],setPath=_useState16[1];var dispatch=useDispatch();useEffect(function(){dispatch(getPost(id));setLinks(post.links);setTitle(post.title);setLoading(false);setBody(post.body);},[id]);var handleAddField=function handleAddField(){setLinks(function(prevLinks){return[].concat(_toConsumableArray(prevLinks),[{name:'',link:''}]);});};var handleDeletePicture=function handleDeletePicture(e){if(e.target.checked){setPath([].concat(_toConsumableArray(path),[e.target.value]));}else{setPath(path.filter(function(item){return item!==e.target.value;}));}};var handleDeleteList=function handleDeleteList(index){if(listCount.includes(index)){setListCount(listCount.filter(function(item){return item!==index;}));}else{setListCount([].concat(_toConsumableArray(listCount),[index]));}};var deleteListHandler=function deleteListHandler(){var updatedLinks=links.filter(function(_,index){return!listCount.includes(index);});setLinks(updatedLinks);setListCount([]);};var handleChange2=function handleChange2(index,fieldName,value){var updatedLinks=_toConsumableArray(links);var updatedLink=_objectSpread({},updatedLinks[index]);updatedLink[fieldName]=value;updatedLinks[index]=updatedLink;setLinks(updatedLinks);};var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var backEndLink,updatedPostData,res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:e.preventDefault();backEndLink=process.env.REACT_APP_BACKEND_URL;setIsEditing(true);_context.prev=3;updatedPostData={image:image,title:title,links:links,path:path,body:body};_context.next=7;return axios.put(\"\".concat(backEndLink,\"/posts/\").concat(id),updatedPostData,{withCredentials:true,headers:{'Content-Type':'multipart/form-data'}});case 7:res=_context.sent;navigate(\"/posts/\".concat(res.data.post._id));console.log(res);// alert(res.data.message);\ntoast.success(res.data.message);_context.next=18;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](3);setIsEditing(false);console.error('Update error:',_context.t0);// alert(err.response.data.message);\ntoast.error(_context.t0.response.data.message);case 18:case\"end\":return _context.stop();}},_callee,null,[[3,13]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return{post:post,loading:loading,title:title,links:links,image:image,body:body,listCount:listCount,path:path,handleAddField:handleAddField,handleDeletePicture:handleDeletePicture,handleDeleteList:handleDeleteList,deleteListHandler:deleteListHandler,handleChange2:handleChange2,handleSubmit:handleSubmit,setBody:setBody,setImage:setImage,setTitle:setTitle,isEditing:isEditing};};","map":{"version":3,"names":["useEffect","useState","useParams","useNavigate","axios","useDispatch","useSelector","getPost","toast","useEditPost","_useParams","id","navigate","_useSelector","state","post","_useState","_useState2","_slicedToArray","loading","setLoading","_useState3","_useState4","isEditing","setIsEditing","_useState5","_useState6","title","setTitle","_useState7","links","_useState8","setLinks","_useState9","_useState10","image","setImage","_useState11","_useState12","body","setBody","_useState13","_useState14","listCount","setListCount","_useState15","_useState16","path","setPath","dispatch","handleAddField","prevLinks","concat","_toConsumableArray","name","link","handleDeletePicture","e","target","checked","value","filter","item","handleDeleteList","index","includes","deleteListHandler","updatedLinks","_","handleChange2","fieldName","updatedLink","_objectSpread","handleSubmit","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","backEndLink","updatedPostData","res","wrap","_callee$","_context","prev","next","preventDefault","process","env","REACT_APP_BACKEND_URL","put","withCredentials","headers","sent","data","_id","console","log","success","message","t0","error","response","stop","_x","apply","arguments"],"sources":["/Users/adnan/Desktop/projects/setup/client-side/src/routes/edit/useEdit.js"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport axios from 'axios';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { getPost } from '../../store/postSlice';\nimport { toast } from 'react-toastify';\n\n\nexport const useEditPost = () => {\n    const { id } = useParams();\n    const navigate = useNavigate();\n\n    const {post} = useSelector(state => state.post)\n    const [loading, setLoading] = useState(true);\n    const [isEditing, setIsEditing] = useState(false);\n    const [title, setTitle] = useState('');\n    const [links, setLinks] = useState(post.links);\n    const [image, setImage] = useState({});\n    const [body, setBody] = useState('');\n    const [listCount, setListCount] = useState([]);\n    const [path, setPath] = useState([]);\n    const dispatch = useDispatch()\n\n    useEffect(() => {\n        dispatch(getPost(id))\n        \n        setLinks(post.links);\n        setTitle(post.title);\n        setLoading(false);\n        setBody(post.body);\n    }, [id]);\n\n    const handleAddField = () => {\n        setLinks((prevLinks) => [...prevLinks, { name: '', link: '' }]);\n    };\n\n    const handleDeletePicture = (e) => {\n        if (e.target.checked) {\n            setPath([...path, e.target.value]);\n        } else {\n            setPath(path.filter((item) => item !== e.target.value));\n        }\n    };\n\n    const handleDeleteList = (index) => {\n        if (listCount.includes(index)) {\n            setListCount(listCount.filter((item) => item !== index));\n        } else {\n            setListCount([...listCount, index]);\n        }\n    };\n\n    const deleteListHandler = () => {\n        const updatedLinks = links.filter((_, index) => !listCount.includes(index));\n        setLinks(updatedLinks);\n        setListCount([]);\n    };\n\n    const handleChange2 = (index, fieldName, value) => {\n        const updatedLinks = [...links];\n        const updatedLink = { ...updatedLinks[index] }; \n        updatedLink[fieldName] = value;\n    \n        updatedLinks[index] = updatedLink; \n    \n        setLinks(updatedLinks); \n    };\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        const backEndLink = process.env.REACT_APP_BACKEND_URL\n        setIsEditing(true)\n        try {\n            const updatedPostData = { image, title, links, path, body };\n            const res = await axios.put(`${backEndLink}/posts/${id}`, updatedPostData, {\n                withCredentials: true,\n                headers: {\n                    'Content-Type': 'multipart/form-data',\n                },\n            });\n            navigate(`/posts/${res.data.post._id}`);\n            console.log(res)\n            // alert(res.data.message);\n            toast.success(res.data.message);\n        } catch (err) {\n            setIsEditing(false)\n            console.error('Update error:', err);\n            // alert(err.response.data.message);\n            toast.error(err.response.data.message);\n        }\n        // dispatch(editPost({ image, title, links, path, body }))\n    };\n\n    return {\n        post,\n        loading,\n        title,\n        links,\n        image,\n        body,\n        listCount,\n        path,\n        handleAddField,\n        handleDeletePicture,\n        handleDeleteList,\n        deleteListHandler,\n        handleChange2,\n        handleSubmit,\n        setBody,\n        setImage,\n        setTitle,\n        isEditing\n    };\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}